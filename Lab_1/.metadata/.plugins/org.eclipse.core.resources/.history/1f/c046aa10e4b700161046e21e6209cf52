import java.util.Random;

public class Broadcast implements Runnable{
	private Process currentProcess;

	private int index;
	private int broadcastNum;
	public Broadcast(Process process, int index, int broadcastNum){
		this.currentProcess=process;
		this.index=index;
		this.broadcastNum = broadcastNum;
	}


	@Override
	public void run() {
		try{
			int broadcast = 1;
		
			while( broadcast <= broadcastNum){
				currentProcess.getClock().increase(index);
				//System.out.println("index: " + index + " " + currentProcess.getClock().toString());

				Clock currentClock = currentProcess.getClock();
				
				String currentId = Integer.toString(currentProcess.getProcessId());
				String message ="Broadcast "+ broadcast  + " Lam Gao Sou ";
				Message m = new Message(currentId, message, currentClock);
				
				broadcast++;
				
				currentProcess.broadcastMessage(m);
				
				Thread.sleep(randomNumber(200,1000));
			}
			
		}catch (Exception e) {
			System.out.println("Exception in broadCast " + e);
		}		
	}
	
	
	public int randomNumber(int low, int high){
		Random r = new Random();
		return r.nextInt(high-low) + low;
	}

}
